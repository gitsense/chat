/*
 * GitSense Chat - Minified Distribution File
 *
 * This JavaScript file is part of the minified distribution of GitSense Chat.
 * It has been optimized (minified) for performance and efficient delivery.
 *
 * This software is permitted for internal use and modification.
 * Copying for profit or redistribution is strictly not permitted.
 *
 * The Fair License, which formalizes these terms, will be adopted as the official license in the future.
 * Once finalized, the unminified source code will be freely available for internal use for non-
 * commercial purposes.
 *
 * This software may not be used to develop or enhance any product or service that competes
 * directly or indirectly with GitSense Chat without explicit permission.
 *
 * Copyright (c) 2025 GitSense. All rights reserved.
 */

function Menus(g,y,e,t={}){let{h:m,svg:a,main:u,DropDownMenu:x}=e,{checkSendOnEnter:r=!0,showNewChatOptions:n,fakeLLMs:k}=t,l={},i=R({type:"cancel"}),w=R({type:"link",icon:"aiModel",text:"Switch model"}),o=R({type:"link",icon:"northStar",text:"New chat"}),d=R({type:"link",icon:"check",text:"Validate"}),s=R({type:"link",icon:"link",text:"Split chat"}),c=R({type:"checkbox",text:"Send on enter"}),p=R({type:"big-small"}),h=R({type:"resize"}),v=null,S=null,b=null,f=null,C=null,D=null,M=null,T=null;function R(e){let{type:t,icon:n,text:l}=e;var i;return"cancel"===t?(e=a.x({style:{marginRight:"3px",verticalAlign:"middle",height:"18px",width:"18px"}}),i=m.createSpan({text:"Cancel",style:{verticalAlign:"middle",fontWeight:600}}),m.createDiv({append:[e,i],style:{display:"inline-block",cursor:"pointer",marginRight:"15px"}})):"link"===t?(e=a[n]({style:{marginRight:"5px",verticalAlign:"middle"}}),i=m.createSpan({text:l,style:{verticalAlign:"middle"}}),m.createDiv({append:[e,i],style:{display:"inline-block",cursor:"pointer",marginRight:"15px"}})):"big-small"===t?((e=a.arrowUp({style:{marginRight:"5px",cursor:"pointer"}})).arrowUp=!0,e):"resize"===t?m.createSpan({append:[a.grabber()],style:{verticalAlign:"middle",fontSize:"16px",position:"relative",top:"-2px",padding:"0px 2px",cursor:"ns-resize"}}):new function(n){this.create=()=>{let e=m.createCheckbox({style:{marginRight:"5px",verticalAlign:"middle"}});e.checked=r;var t=m.createSpan({text:n,style:{verticalAlign:"middle",cursor:"pointer"}});return t.onclick=()=>{e.click()},{checkbox:e,element:m.createDiv({append:[e,t],style:{display:"inline-block",cursor:"pointer",marginRight:n.match(/send/i)?"10px":"15px"}})}}}(l).create()}function L(){l.onResize&&setTimeout(()=>{l.onResize()},100)}function A(e){var t;"hide"===e?(e=u.getWidth()-60,t=`calc(100% - ${f.getBoundingClientRect().width}px)`,S.style.display="inline-block",b.style.display="none",v.style.width=e,S.style.width=t):(S.style.display="none",b.style.display="inline-block",v.style.width=null,S.style.width=null)}function B(a){let o="frankenstein-chat"===a,r="new-chat"===a,d="validate-chat"===a,s="split-chat"===a;let c=null,p=null,h=null;this.getSelectedRelation=()=>h?h.getSelected():null,this.getSelectedModels=()=>p?[p.getSelected()]:null,this.render=l=>{var{headerBody:l,relationsBody:i,modelsBody:e}=(e=>{var t=m.createDiv({style:{borderTop:"1px solid #ccc",marginTop:"10px",paddingTop:"15px"}}),n=m.createDiv({style:{display:"inline-block",textAlign:"left",marginRight:"20px"}}),l=m.createDiv({style:{display:"inline-block",textAlign:"left"}}),i=m.createDiv({append:[n,l],style:{textAlign:"center",marginTop:"12px",marginBottom:"10px",border:"1px dashed #aaa",borderRadius:"5px",padding:"12px"}});return c=m.createDiv({append:[t,i],style:{paddingBottom:"5px"}}),e.appendChild(c),{headerBody:t,relationsBody:n,modelsBody:l}})(l=l);o||!function n(l,t){t=t||(o?"Next message":"Child");let e=o?["Next message"]:["None","Child","Sibling"];let i=[];e.forEach(e=>{i.push({value:e,selected:t===e})});let a=r?"New":"Split";h=new x(i,`<strong>${a} chat relation</strong>: `,{alignment:"se",dropDownClass:"",dropDownStyle:{marginLeft:"4px"},callback:async(e,t)=>{l.innerHTML="",n(l,t)}});l.appendChild(h.create())}(i);{i=l;let e=null,t=null,n=null;if(r)e="New Chat",t="Start a new related or unrelated chat",n="Ask selected model anything...";else if(s)e="Split Chat",t="Move chat history to background memory to start a clutter-free conversation.",n="Ask selected model anything...";else if(d)e="Summarize and Validate Chat",t="Use one or more models below to summarize and validate the conversation.",n="Leave message blank or write your own message";else{if(!w)throw new Error("Unrecognized new chat type "+a);e="Switch model",t="Ask your next question with a different model.",n="Ask another model anything..."}u.updatePlaceholder(n),i.appendChild(m.createH4({text:e})),i.appendChild(m.createDiv({text:t,style:{marginTop:"5px"}}))}(function n(l,i){i=i||(o?"":g);let e="GitSense Notes";let a=[...y];g===e&&o||(a.unshift({name:"----"}),a.unshift({name:e}));o&&a.unshift({name:">>>Select another model"});if(k){a.push({name:"----"});for(let t=1;t<=k;t++){let e="Fake LLM Simulator "+t;a.push({name:e})}}let r=[];a.forEach(e=>{let t=e.name;o&&t===g||r.push({value:t,selected:i===t})});let t=o?g+" &nbsp;&rarr;&nbsp; ":"<strong>Model: </strong>";p=new x(r,t,{alignment:"ne",dropDownClass:"",dropDownStyle:{marginLeft:"4px"},menuStyle:{width:"300px",zIndex:1e8},callback:async(e,t)=>{t.match(/select/i)||""===t||(l.innerHTML="",n(l,t))}});l.appendChild(p.create())})(e)},this.destroy=()=>{c&&c.parentNode&&c.parentNode.removeChild(c),p=null,h=null}}this.sendOnEnter=()=>c.checkbox.checked,this.getResize=()=>h,this.getSelectedOption=()=>M,this.getSelectedRelation=()=>T?T.getSelectedRelation():"Next message",this.getSelectedModels=()=>T&&T.getSelectedModels()||[g],this.reset=()=>{u.resetPlaceholder(),A("show"),D.innerHTML="",D.style.display="none",M=null,L(),l.onClickBigSmall&&(p.arrowUp=!0,p.innerHTML=a.arrowUp().innerHTML,l.onClickBigSmall("small")),T&&(T.destroy(),T=null)},this.setEvent=(e,t)=>{l[e]=t},this.showError=e=>{D.style.display=null,D.innerText=e},this.render=e=>{S=m.createDiv({style:{display:"none",textAlign:"left"}}),b=m.createDiv({style:{display:"inline-block"}}),f=m.createDiv({style:{display:"inline-block"}}),C=m.createDiv({style:{}}),D=m.createDiv({style:{display:"none",textAlign:"center",marginTop:"5px",marginBottom:"5px",padding:"5px",backgroundColor:"#FFCDD2"}}),v=m.createDiv({append:[S,n?b:null,f,C,D],style:{display:"inline-block",backgroundColor:"white",padding:"10px 20px",border:"1px solid #ccc",borderBottom:"0px",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",whiteSpace:"nowrap",fontSize:"14px"}}),e.appendChild(v),S.appendChild(i),b.appendChild(w),b.appendChild(o),f.appendChild(c.element),f.appendChild(p),f.appendChild(h),i.onclick=()=>{u.resetPlaceholder(),A("show"),M=null,D.innerHTML="",D.style.display="none",T&&T.destroy(),L()},w.onclick=()=>{A("hide"),M="frankenstein-chat",(T=new B(M)).render(C),L()},o.onclick=()=>{A("hide"),M="new-chat",(T=new B(M)).render(C),L()},d.onclick=()=>{A("hide"),M="validate-chat",(T=new B(M)).render(C),L()},s.onclick=()=>{A("hide"),M="split-chat",(T=new B(M)).render(C),L()},p.onclick=()=>{l.onClickBigSmall&&(p.arrowUp?(p.innerHTML=a.arrowDown().innerHTML,p.arrowUp=null,l.onClickBigSmall("big")):(p.innerHTML=a.arrowUp().innerHTML,p.arrowUp=!0,l.onClickBigSmall("small")),L())},c.onclick=()=>{sendOnEnterCheckbox.click()}}}module.exports={Menus:Menus};
