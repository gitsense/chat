/*
 * GitSense Chat - Minified Distribution File
 *
 * This JavaScript file is part of the minified distribution of GitSense Chat.
 * It has been optimized (minified) for performance and efficient delivery.
 *
 * This software is permitted for internal use and modification.
 * Copying for profit or redistribution is strictly not permitted.
 *
 * The Fair License, which formalizes these terms, will be adopted as the official license in the future.
 * Once finalized, the unminified source code will be freely available for internal use for non-
 * commercial purposes.
 *
 * This software may not be used to develop or enhance any product or service that competes
 * directly or indirectly with GitSense Chat without explicit permission.
 *
 * Copyright (c) 2025 GitSense. All rights reserved.
 */

let{h,svg}=require("../../../../Dependencies");function MessageSelectionList(e={}){let{messages:d=[],initialSelection:t={system:!0,user:!0,assistant:!0},onChange:s=()=>{}}=e,m={...t},y=new Map,r=null;function a(){var e=h.createDiv({className:"gs-message-selection-panel",style:{width:"100%",display:"flex",flexDirection:"column",gap:"16px"}}),t=h.createDiv({className:"gs-message-type-filters",style:{padding:"12px",backgroundColor:"#f5f5f5",borderRadius:"4px"}}),s=h.createH4({text:"Types",style:{margin:"0 0 12px 0",fontSize:"14px"}});t.appendChild(s);let i=h.createDiv({style:{display:"flex",flexDirection:"row",gap:"24px",width:"100%"}});t.appendChild(i),[{id:"system",label:"System"},{id:"user",label:"User"},{id:"assistant",label:"Assistant"}].forEach(e=>{var t=h.createDiv({style:{display:"flex",alignItems:"center"}});let s=h.createInput({type:"checkbox",id:"message-type-"+e.id,checked:m[e.id]});s.addEventListener("change",()=>{m[e.id]=s.checked,p(),x()});var a=h.createLabel({for:"message-type-"+e.id,text:e.label,style:{marginLeft:"8px",cursor:"pointer"}});t.appendChild(s),t.appendChild(a),i.appendChild(t)}),e.appendChild(t);s=h.createDiv({className:"gs-message-list-container",style:{flex:1,overflow:"auto",border:"1px solid #e8e8e8",borderRadius:"4px"}}),t=h.createDiv({style:{display:"flex",alignItems:"center",padding:"8px 16px",borderBottom:"1px solid #e8e8e8"}});let a=h.createInput({type:"checkbox",id:"select-all-messages",checked:!0});a.addEventListener("change",()=>{let t=a.checked;d.forEach(e=>{m[e.role]&&y.set(e.id,t)}),r&&r.querySelectorAll('.gs-message-item input[type="checkbox"]').forEach(e=>{var t=e.dataset.messageId;t&&(e.checked=y.get(t)||!1)}),x()});var l=h.createLabel({for:"select-all-messages",text:d.length+" message"+(1!==d.length?"s":""),style:{marginLeft:"8px",fontWeight:500,cursor:"pointer"}});t.appendChild(a),t.appendChild(l),s.appendChild(t);let n=h.createDiv({className:"gs-message-list",style:{display:"flex",flexDirection:"column",gap:"8px",padding:"8px"}});return d.forEach((e,t)=>{e=((e,t)=>{let{id:s,role:a,content:i}=e,l=h.createDiv({className:"gs-message-item gs-message-"+a,"data-message-id":s,"data-message-role":a,style:{display:m[a]?"flex":"none",alignItems:"flex-start",padding:0===t?"8px":"16px 8px 8px 8px",borderTop:0===t?null:"1px solid #eee"}}),n=h.createInput({type:"checkbox",id:"message-"+s,"data-message-id":s,checked:y.get(s),style:{marginTop:"4px"}}),d=(n.addEventListener("change",()=>{y.set(s,n.checked),x()}),h.createDiv({className:"gs-message-item-content",style:{marginLeft:"8px",flex:1,overflow:"hidden"}})),r=h.createDiv({style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"}}),p=h.createDiv({className:"gs-message-item-role",text:a.charAt(0).toUpperCase()+a.slice(1)}),c=h.createDiv({style:{cursor:"pointer",marginLeft:"8px",opacity:"0",transition:"opacity 0.2s ease"}}),o=(c.appendChild(svg.copy({width:14,height:14})),c.addEventListener("click",e=>{e.stopPropagation(),e=i,navigator.clipboard.writeText(e).then(()=>{c.innerHTML="",c.appendChild(svg.check({width:14,height:14,style:"fill: #4CAF50; transition: opacity 0.3s ease;"})),setTimeout(()=>{c.innerHTML="",c.appendChild(svg.copy({width:14,height:14,style:"transition: opacity 0.3s ease;"}))},2e3)})}),r.appendChild(p),r.appendChild(c),h.createDiv({className:"gs-message-item-preview",style:{fontSize:"12px",color:"#666",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"}})),g=""===i?"<empty message>":i.substring(0,100)+(100<i.length?"...":"");return o.textContent=g,d.appendChild(r),d.appendChild(o),l.appendChild(n),l.appendChild(d),l.addEventListener("mouseenter",()=>{c.style.opacity="1"}),l.addEventListener("mouseleave",()=>{c.style.opacity="0"}),l})(e,t);n.appendChild(e)}),s.appendChild(n),e.appendChild(s),e}function p(){r&&r.querySelectorAll(".gs-message-item").forEach(e=>{var t=e.dataset.messageRole;t&&void 0!==m[t]&&(e.style.display=m[t]?"flex":"none")})}function x(){var e=d.filter(e=>m[e.role]&&y.get(e.id));s(e)}return d.forEach(e=>{y.set(e.id,!0)}),{render:function(e){r=r||a(),e.appendChild(r)},getSelectedMessages:function(){return d.filter(e=>m[e.role]&&y.get(e.id))},setSelectedMessageTypes:function(t){t&&"object"==typeof t&&(Object.keys(t).forEach(e=>{void 0!==m[e]&&(m[e]=!!t[e])}),r&&(Object.keys(m).forEach(e=>{var t=r.querySelector("#message-type-"+e);t&&(t.checked=m[e])}),p()),x())},updateMessageVisibility:p}}module.exports=MessageSelectionList;
