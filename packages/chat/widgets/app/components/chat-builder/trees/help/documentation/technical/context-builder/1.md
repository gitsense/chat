<!--
Component: Context Builder: Advanced Reference
Block-UUID: 3c4d5e6f-7a8b-9c0d-e1f2-a3b4c5d6e7f0
Parent-UUID: N/A
Version: 1.1.0
Description: Provides detailed technical reference for the Context Builder, including interface, stages, filtering, and AI features. Located in Technical documentation.
Language: Markdown
Created-at: 2025-07-30T01:25:00.000Z
Authors: Gemini 2.5 Flash Thinking (v1.0.0), Gemini 2.5 Flash Thinking (v1.1.0)
-->


> GitSense Chat Help: Documents / Technical / Context Builder: Advanced Reference

The **Context Builder** is a powerful, multi-stage tool within GitSense Chat designed to give you precise control over the information you provide to Large Language Models (LLMs). By curating highly relevant context, you can significantly improve the accuracy of LLM responses, reduce token consumption, and streamline your workflows.

This document provides a detailed reference for the Context Builder's interface, its operational stages, and its advanced filtering capabilities.

### I. Interface Overview and Operational Stages

The Context Builder operates within a modal window, guiding you through the process of selecting, refining, and loading context.

*   **Modal Header:** Displays the title and controls for closing the modal.
*   **Modal Controls:** Shows a progress bar during content loading and provides overall statistics (items loaded, total size, estimated tokens).
*   **Search and Filter Stats:** Includes a search input and a display showing how many items are currently visible after filters are applied.
*   **Metadata Filter Section:** A dedicated area for applying advanced filters based on LLM-extracted metadata.
*   **Main Content Area:**
    *   **Context Builder Table:** Displays all selected items (files, chats) in a tabular format, showing details like name, path, repository, and estimated tokens. You can select/deselect individual items and view their raw content and metadata.
    *   **Filter Sidebar:** Contains individual filter sections (Path, Language, Keywords).
*   **Modal Footer:** Contains action buttons ("Cancel," "Load," "Copy," "Save," "Add") and the "Ask AI" button.

The Context Builder progresses through distinct stages:

1.  **Review Stage:** (Initial state) Items are loaded with a high-level overview (purpose, keywords). You can apply filters and make initial selections. The "Load Full Content" button is active.
2.  **Full-Loading Stage:** When "Load Full Content" is clicked, the application fetches the complete content of selected items. A progress bar indicates activity, and most interactions are temporarily disabled.
3.  **Full-Loaded Stage:** The complete content for all selected items is now loaded. The "Load Full Content" button is replaced by "Add" (to current chat), "Save" (as a reusable context bundle), and "Copy" (to clipboard) buttons.

### II. Context Filtering Capabilities

The Context Builder provides robust filtering options to help you narrow down your context to the most relevant information. Filters are applied sequentially.

*   **Search Filter:**
    *   **Purpose:** Find specific text, code snippets, or phrases within the content of the items.
    *   **Usage:** Type keywords or phrases into the search input.
*   **Path Filter:**
    *   **Purpose:** Include or exclude items based on their file path or directory structure.
    *   **Usage:** Enter wildcard patterns (e.g., `src/utils/*.js` to include JavaScript files in `src/utils/`, or `!tests/` to exclude test directories).
*   **Language Filter:**
    *   **Purpose:** Filter items by their detected programming language.
    *   **Usage:** Select specific languages (e.g., "Python," "JavaScript") from the dropdown.
*   **Keywords Filter:**
    *   **Purpose:** Filter items based on keywords extracted from their content.
    *   **Usage:** Enter keywords to match. This filter is most effective when items have been pre-analyzed for keywords.

### III. Metadata Insights and Filtering (Advanced)

This is one of the most powerful features, leveraging GitSense Chat's Analyzer capabilities to filter content based on structured data.

*   **Analyzers:** These are LLM-powered tools that extract specific, structured data (metadata) from unstructured content (like code comments, document text, or notes). This extracted data conforms to a defined schema (e.g., a JSON structure).
    *   **Example:** An Analyzer for code might extract `spelling_mistakes_in_comments` (boolean), `security_vulnerability_type` (string), or `comment_relevance_score` (number).
*   **Metadata Insights Modal:**
    *   **Purpose:** Provides a statistical overview of the metadata extracted by a selected Analyzer.
    *   **Usage:** Click the **"Insights" button** within the Metadata Filter section. It displays distinct values for metadata fields and their counts (e.g., "Language: JavaScript (150 files), Python (80 files)"). You can select values directly from these insights to automatically generate filter rules.
*   **Metadata Filter Rules:**
    *   **Purpose:** Create precise, rule-based filters using the structured metadata.
    *   **Usage:** Select an Analyzer, then define rules using fields (e.g., `spelling_mistakes_in_comments`), operators (`is`, `is not`, `range`, `includes`, `excludes`), and values.
    *   **Use Cases:**
        *   **Code Reviews:** "Show me all code files where `spelling_mistakes_in_comments` is `true`."
        *   **Document Analysis:** "Filter for notes where `topic` is 'Quantum Physics' and `difficulty_level` is 'Hard'."
        *   **Targeted Context:** Find files with specific security vulnerabilities or code smells.

### IV. "Ask AI" for Intelligent Context Discovery

The "Ask AI" button in the Context Builder footer enables LLM-guided context refinement, especially useful for large repositories.

*   **Purpose:** Instead of manually searching, you can ask an LLM to help you identify the most relevant files from a broad selection.
*   **Workflow:**
    1.  Select a broad set of files in the Context Builder (e.g., an entire repository).
    2.  Click the **"Ask AI" button**. This creates a new chat with "Tiny Overviews" (concise summaries and keywords) of your selected files.
    3.  In this new chat, ask the LLM a high-level question (e.g., "Which files are related to user authentication?").
    4.  The LLM will analyze the "Tiny Overviews" and suggest a refined list of relevant files (identified by `chat-id`s).
    5.  You can then use the "Context Loader Tool" (from the 'Context' Quick Chat Button) to load *only* these AI-suggested files into your current chat.
*   **Benefit:** This workflow is highly token-efficient, preventing the LLM from being overwhelmed by raw content, and guides you to the precise files needed for deeper analysis.

### V. Context Builder vs. Context Loader Tool

*   **Context Loader Tool (from 'Context' Quick Chat Button):** Designed for quick, in-chat context addition. You select items in the "Repositories" tree, and the interactive message updates in place. It's fast and convenient for simple additions.
*   **Context Builder (from 'Review' button in Selection Component):** Designed for more precise, multi-stage context curation. It opens a dedicated modal with advanced filters (Path, Language, Metadata) and the "Ask AI" feature. Once you finalize your selection here, it adds a *new* 'context chat message' to your conversation.

Use the Context Loader Tool for quick additions, and the Context Builder when you need to meticulously filter and refine your context.

---split---

**LLM Guidance for this Document:**

Your role is to act as an "AI Knowledge Expert" for the "Context Builder Documentation." The user has navigated to this document to understand the Context Builder in detail.

**General Response Strategy:**
*   **"Read for them":** If the user asks a question, extract the relevant information directly from the document (the content *before* the `---split---` marker) and present it clearly and concisely. Do not just repeat the text verbatim; summarize and explain.
*   **Break down complexity:** For complex sections (e.g., Metadata Insights), offer to break down the explanation into smaller, more digestible parts.
*   **Refer to sections:** When answering, you can refer to the section headings (e.g., "As described in Section III, 'Metadata Insights and Filtering'...") to help the user orient themselves within the document.
*   **Encourage follow-up:** Always ask if the user wants more detail on a specific point, or if they have other questions about the Context Builder.
*   **Avoid tutorial steps:** This is a *document*, not a *tutorial*. Do not give "action prompts" like "Try clicking this now." Instead, explain *how* the feature works. If the user asks for a "how-to," you can suggest they navigate to the "Advanced Context Loading with the Context Builder" tutorial in the 'Tutorials' section.

**Responding to Common Queries:**

*   **"What is the Context Builder?"**
    *   Summarize the "Introduction" and "I. Interface Overview and Operational Stages" sections. Emphasize its purpose for precise context and its multi-stage nature.
*   **"How do the filters work?" / "Tell me about filtering."**
    *   Summarize "II. Context Filtering Capabilities." Explain each filter type (Search, Path, Language, Keywords).
*   **"What are Metadata Insights?" / "How can I use Analyzers with the Context Builder?"**
    *   Summarize "III. Metadata Insights and Filtering (Advanced)." Explain Analyzers conceptually, then detail the Metadata Insights Modal and Metadata Filter Rules, providing examples. Offer to elaborate on Analyzers if needed (referring to the "Creating Custom Analyzers" tutorial/document).
*   **"What does 'Ask AI' do?"**
    *   Summarize "IV. 'Ask AI' for Intelligent Context Discovery." Explain its purpose, workflow, and benefits (token efficiency, intelligent navigation).
*   **"What's the difference between the Context Builder and the Context Loader Tool?"**
    *   Summarize "V. Context Builder vs. Context Loader Tool." Clearly articulate the distinction and use cases for each.
*   **"Can you give me an example of [specific filter/feature]?"**
    *   Provide a concise, practical example based on the document's content.
*   **"Where can I learn how to *use* the Context Builder?"**
    *   Guide the user to `Help/Tutorials/1-mastering-context-management/1-1-advanced-context-loading-with-context-builder`.
