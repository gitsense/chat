/*
 * GitSense Chat - Minified Distribution File
 *
 * This JavaScript file is part of the minified distribution of GitSense Chat.
 * It has been optimized (minified) for performance and efficient delivery.
 *
 * This software is permitted for internal use and modification.
 * Copying for profit or redistribution is strictly not permitted.
 *
 * The Fair License, which formalizes these terms, will be adopted as the official license in the future.
 * Once finalized, the unminified source code will be freely available for internal use for non-
 * commercial purposes.
 *
 * This software may not be used to develop or enhance any product or service that competes
 * directly or indirectly with GitSense Chat without explicit permission.
 *
 * Copyright (c) 2025 GitSense. All rights reserved.
 */

let h=require("../../../../Dependencies").h,{CSS_CLASSES,formatSearchCriteriaOptions}=require("./DirectSearchResultsUtils");function render(e,t,a){let{searchCriteria:i,pagination:n}=e;var{currentPage:r,totalPages:l,totalResults:o}=n,t=t.visibility,p=h.createDiv({cls:CSS_CLASSES.HEADER}),c=h.createDiv({style:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),c=(c.appendChild(h.createH2({text:"Search Results",style:{marginTop:"0px"}})),0<l&&c.appendChild(h.createSpan({text:`(Page ${r} of ${l})`,style:{fontSize:"0.9em",color:"#666",marginLeft:"10px"}})),p.appendChild(c),h.createDiv({cls:CSS_CLASSES.VISIBILITY_NOTICE,style:{marginBottom:"15px"}})),t=("human-public"===t?(c.appendChild(h.createSpan({text:"This search result is currently not visible to LLMs. "})),h.createLink({text:"Click here to make visible.",href:"#",cls:CSS_CLASSES.LINK_BUTTON}).addEventListener("click",e=>{e.preventDefault(),a.onMakeVisibleToAIClick&&a.onMakeVisibleToAIClick()})):(c.appendChild(h.createSpan({text:"This search result is now "})),c.appendChild(h.createSpan({text:"visible to the AI Assistant",style:{fontWeight:"bold"}})),c.appendChild(h.createSpan({text:"."}))),p.appendChild(c),h.createPre({cls:CSS_CLASSES.QUERY_BLOCK,text:e.query||"",style:{backgroundColor:"#f4f4f4",border:"1px solid #ddd",padding:"10px",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-all",marginBottom:"15px"}})),c=(p.appendChild(t),h.createDiv({style:{marginBottom:"15px",fontSize:".9em"}})),e=h.createLink({text:"Execute Search Again",href:"#",cls:CSS_CLASSES.LINK_BUTTON,style:{marginRight:"15px"}}),t=(e.addEventListener("click",e=>{e.preventDefault(),a.onExecuteSearchAgain&&a.onExecuteSearchAgain()}),c.appendChild(e),h.createLink({text:"Execute New Search",href:"#",cls:CSS_CLASSES.LINK_BUTTON})),e=(t.addEventListener("click",e=>{e.preventDefault(),a.onExecuteNewSearch&&a.onExecuteNewSearch()}),c.appendChild(t),h.createDiv({style:{marginTop:"15px",marginBottom:"10px"}}));e.appendChild(h.createDiv({html:formatSearchCriteriaOptions(i)}));let s=h.createLink({text:" [View All Details]",href:"#",cls:CSS_CLASSES.LINK_BUTTON+" "+CSS_CLASSES.VIEW_ALL_DETAILS,style:{color:"#007bff",cursor:"pointer",marginLeft:"5px"}}),d=(p.appendChild(e),h.createDiv({cls:CSS_CLASSES.COLLAPSIBLE_CONTENT,style:{display:"none",marginBottom:"15px"}}));d.appendChild(h.createPre({text:JSON.stringify(i,null,2),style:{backgroundColor:"#f9f9f9",border:"1px dashed #eee",padding:"10px",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-all"}})),p.appendChild(d),s.addEventListener("click",e=>{e.preventDefault();e="none"===d.style.display;d.style.display=e?"block":"none",s.textContent=e?"[Hide Details]":"[View All Details]"}),0<o&&p.appendChild(h.createDiv({text:`(${o} Total Matches)`,style:{marginTop:"20px",marginBottom:"10px"}}));var S=h.createDiv({cls:CSS_CLASSES.PAGINATION,style:{marginBottom:"15px"}});if(1<l){1<r&&((c=h.createLink({text:"[Previous Page]",href:"#",cls:CSS_CLASSES.LINK_BUTTON,style:{color:"#007bff",cursor:"pointer",marginRight:"10px"}})).addEventListener("click",e=>{e.preventDefault(),a.onPaginationClick&&a.onPaginationClick(i.pagination.offset-i.pagination.limit)}),S.appendChild(c));let e=Math.max(1,r-Math.floor(2.5));var C=Math.min(l,e+5-1);1<(e=C-e+1<5?Math.max(1,C-5+1):e)&&S.appendChild(h.createSpan({text:"... ",style:{marginRight:"5px"}}));for(let t=e;t<=C;t++){var x=h.createLink({text:`[Page ${t}]`,href:"#",cls:CSS_CLASSES.LINK_BUTTON,style:{color:t===r?"#333":"#007bff",fontWeight:t===r?"bold":"normal",cursor:"pointer",margin:"0 3px"}});t!==r&&x.addEventListener("click",e=>{e.preventDefault(),a.onPaginationClick&&a.onPaginationClick((t-1)*i.pagination.limit)}),S.appendChild(x)}C<l&&S.appendChild(h.createSpan({text:" ...",style:{marginLeft:"5px"}})),r<l&&((t=h.createLink({text:"[Next Page]",href:"#",cls:CSS_CLASSES.LINK_BUTTON,style:{color:"#007bff",cursor:"pointer",marginLeft:"10px"}})).addEventListener("click",e=>{e.preventDefault(),a.onPaginationClick&&a.onPaginationClick(i.pagination.offset+i.pagination.limit)}),S.appendChild(t))}return p.appendChild(S),p.appendChild(h.createHr({style:{border:"none",borderTop:"1px solid #eee",margin:"20px 0"}})),p}module.exports={render:render};
