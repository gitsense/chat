/*
 * GitSense Chat - Minified Distribution File
 *
 * This JavaScript file is part of the minified distribution of GitSense Chat.
 * It has been optimized (minified) for performance and efficient delivery.
 *
 * This software is permitted for internal use and modification.
 * Copying for profit or redistribution is strictly not permitted.
 *
 * The Fair License, which formalizes these terms, will be adopted as the official license in the future.
 * Once finalized, the unminified source code will be freely available for internal use for non-
 * commercial purposes.
 *
 * This software may not be used to develop or enhance any product or service that competes
 * directly or indirectly with GitSense Chat without explicit permission.
 *
 * Copyright (c) 2025 GitSense. All rights reserved.
 */

let{h,svg,Dropdown}=require("../Dependencies");function renderInputControl(e,t){if(!e||!e.type||!e.name)return console.warn("renderInputControl: Invalid control configuration:",e),null;let l=null;switch(e.type){case"caseSensitive":case"regex":var n="enabled"===e.initialState;l=h.createSpan({text:e.label||"",name:e.name,cls:"search-tool-input-control",style:{fontWeight:"bold",color:n?"#000":"#aaa",cursor:"pointer",marginLeft:"5px"},__controlConfig:e,"data-control-type":e.type,"data-state":n?"enabled":"disabled"});break;case"clear":n=e.svg?svg[e.svg]({style:{fill:"#aaa"}}).outerHTML:null;(l=h.createSpan({html:n,text:n?null:e.label||"X",name:e.name,cls:"search-tool-input-control search-tool-clear-input",style:{fontWeight:"bold",color:"#aaa",cursor:"pointer",marginLeft:"5px"},__controlConfig:e,"data-control-type":e.type})).x=n;break;default:return console.warn(`renderInputControl: Unrecognized control type "${e.type}"`),null}if(l&&e.style)for(var a in e.style)l.style[a]=l.style[a]||e.style[a];return l&&(l.__associatedInput=t),l}function renderUI(n,a,r={}){if(!n||!a)return console.error("renderUI: Missing config or container."),null;if(r.searchTargetOptions&&(n.searchTargetOptions=r.searchTargetOptions),n.style)for(var e in n.style)a.style[e]=n.style[e];return n.layout&&Array.isArray(n.layout)&&n.layout.forEach(e=>{if("row"===e.type&&Array.isArray(e.elements)){let l=h.createDiv({cls:"search-tool-row",style:{display:"flex",alignItems:"center"}});if(e.style)for(var t in e.style)l.style[t]=l.style[t]||e.style[t];Array.isArray(e.elements)&&Array.isArray(e.elements[0])?e.elements.forEach(e=>{if(Array.isArray(e)){let t=h.createDiv({cls:"search-tool-element-group",style:{display:"flex",alignItems:"center"}});e.forEach(e=>{e=renderElement(e,r,n);e&&t.appendChild(e)}),l.appendChild(t)}else console.warn("renderUI: Invalid element group configuration within row:",e)}):e.elements.forEach(e=>{e=renderElement(e,r,n);e&&l.appendChild(e)}),a.appendChild(l)}else console.warn("renderUI: Invalid row configuration:",e)}),n.sections&&Array.isArray(n.sections)&&n.sections.forEach(e=>{e=renderSection(e,r,n);e&&a.appendChild(e)}),a}function renderElement(o,i,s){if(!o||!o.type||!o.name)return console.warn("renderElement: Invalid element configuration:",o),null;let c=null;switch(o.type){case"text":c=h.createSpan({text:o.text||"",name:o.name});break;case"image":c=h.createImg({src:o.src||"",alt:o.alt||"",name:o.name});break;case"input":case"textarea":var p="textarea"===o.type,d=s.defaults&&void 0!==s.defaults.query?s.defaults.query:o.defaultValue;let t=h.createDiv({style:{display:"flex",alignItems:"center",flex:o.flex||"0 1 auto",border:"1px solid #ccc",borderRadius:"4px",padding:"0 5px 0px 0px"}}),l=p?h.createTextArea({placeholder:o.placeholder||"",value:d||"",name:o.name,style:{flexGrow:1,border:"none",outline:"none",padding:"8px",marginRight:o.controls&&o.controls.length?"2px":null,resize:"none",overflowY:"hidden",minHeight:o.style?.minHeight||"38px"},__elementConfig:o}):h.createInput({type:"text",placeholder:o.placeholder||"",value:d||"",name:o.name,style:{flexGrow:1,border:"none",outline:"none",padding:"8px",marginRight:o.controls&&o.controls.length?"2px":null},__elementConfig:o});t.classList.add(`search-tool-${o.type}-container`),"queryInput"===o.name&&p&&t.classList.add("search-tool-query-input-container"),p&&(l.addEventListener("input",()=>{l.style.height="auto",l.style.height=l.scrollHeight+"px"}),setTimeout(()=>{l.dispatchEvent(new Event("input"))},0)),t.appendChild(l),c=t,Array.isArray(o.controls)&&o.controls.forEach(e=>{e=renderInputControl(e,l);e&&t.appendChild(e)});break;case"button":c=h.createButton({text:o.label||"Button",name:o.name,cls:"btn"});break;case"radio-group":c=h.createDiv({cls:"search-tool-radio-group"}),o.label&&(d=h.createSpan({text:o.label,style:{marginRight:"5px",fontWeight:"bold"}}),c.appendChild(d)),Array.isArray(o.options)&&o.options.forEach(e=>{var t=o.name+"-"+e.value,l=h.createInput({type:"radio",name:o.name,value:e.value,id:t,checked:o.defaultValue===e.value}),e=h.createLabel({text:e.label,for:t,style:{marginRight:"10px"}});c.appendChild(l),c.appendChild(e)});break;case"link":c=h.createLink({text:o.label||"Link",href:"#",name:o.name,style:{cursor:"pointer"}}),o.align&&(c.style.textAlign=o.align);break;case"checkbox":c=h.createDiv({style:{display:"flex",alignItems:"center"}});p=h.createInput({type:"checkbox",name:o.name,id:o.name,checked:"function"==typeof o.defaultValue?o.defaultValue(s.defaults||{}):!0===o.defaultValue}),d=h.createLabel({text:o.label||"Checkbox",for:o.name,style:{marginLeft:"right"===o.labelPosition?"5px":null,marginRight:"left"===o.labelPosition?"5px":null}});"right"===o.labelPosition?(c.appendChild(p),c.appendChild(d)):(c.appendChild(d),c.appendChild(p));break;case"multi-select":c=h.createDiv({style:{display:"flex",alignItems:"center"}}),o.label&&(d=h.createSpan({text:o.label,style:{marginRight:"5px",fontWeight:"bold"}}),c.appendChild(d));let n=h.createSelect({name:o.name,multiple:!0,style:{minWidth:"100px"}});Array.isArray(o.defaultValue)&&o.defaultValue.includes(option.value);p="function"==typeof o.options?o.options(i):o.options;Array.isArray(p)&&p.forEach(e=>{var t=h.createOption({value:e.value,text:e.label});Array.isArray(o.defaultValue)&&o.defaultValue.includes(e.value)&&(t.selected=!0),n.appendChild(t)}),c.appendChild(n);break;case"select":c=h.createDiv({style:{display:"flex",alignItems:"center"}}),null!==o.label?(d=h.createSpan({text:o.label,style:{marginRight:"3px",fontWeight:500}}),c.appendChild(d)):c.style.marginRight="3px";let e=o.options;"function"==typeof o.options&&(e=o.options(i,s));p=Array.isArray(e)?e.map(e=>({value:e.value,text:e.label})):[];let a=h.createDiv({name:o.name,style:{flexGrow:1}}),r=o.defaultValue;"function"==typeof o.defaultValue&&(r=o.defaultValue(i,s));d=new Dropdown(a,{label:null,options:p,initialValue:r,caretFontSize:"0.4em"});d.onChangeCallback=(e,t)=>{console.log(`Dropdown "${o.name}" changed from "${t}" to "${e}"`);e=new CustomEvent("search-tool:element-change",{detail:{name:o.name,value:e,previousValue:t},bubbles:!0});a.dispatchEvent(e)},a.__dropdownInstance=d,a.__elementConfig=o,c.appendChild(a);break;default:return console.warn(`renderElement: Unrecognized element type "${o.type}"`),null}if(c&&o.style)for(var e in o.style)"function"==typeof o.style[e]?c.style[e]=o.style[e](s.defaults):c.style[e]=o.style[e]||c.style[e];return c&&"select"!==o.type&&(c.__elementConfig=o),c}function renderSection(e,a,r){if(!e||!e.type||!e.name)return console.warn("renderSection: Invalid section configuration:",e),null;let t=null;if("collapsible"!==e.type)return console.warn(`renderSection: Unrecognized section type "${e.type}"`),null;{t=h.createDiv({cls:"search-tool-collapsible-section",name:e.name});var l=h.createDiv({cls:"search-tool-collapsible-header",text:e.label||"Section",style:{cursor:"pointer",fontWeight:"bold",marginTop:"10px"}});t.appendChild(l);let n=h.createDiv({cls:"search-tool-collapsible-content",style:{display:!1===e.visible?"none":"block",paddingLeft:"10px"}});t.appendChild(n),e.layout&&Array.isArray(e.layout)&&e.layout.forEach(e=>{if("row"===e.type&&Array.isArray(e.elements)){var t=h.createDiv({cls:"search-tool-row",style:{display:"flex",alignItems:"center"}});if(e.style)for(var l in e.style)t.style[l]=t.style[l]||e.style[l];Array.isArray(e.elements)&&Array.isArray(e.elements[0])?e.elements.forEach(e=>{if(Array.isArray(e)){let t=h.createDiv({cls:"search-tool-element-group",style:{display:"flex",alignItems:"center"}});e.forEach(e=>{e=renderElement(e,a,r);e&&t.appendChild(e)}),n.appendChild(t)}else console.warn("renderSection: Invalid element group configuration within section row:",e)}):e.elements.forEach(e=>{e=renderElement(e,a,r);e&&n.appendChild(e)})}else console.warn("renderSection: Invalid row configuration within section:",e)}),l.addEventListener("click",()=>{var e="none"===n.style.display;n.style.display=e?"block":"none"})}if(t&&e.style)for(var n in e.style)t.style[n]=t.style[n]||e.style[n];return t&&(content.__elementConfig=e),t}module.exports={renderUI:renderUI};
