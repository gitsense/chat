/*
 * GitSense Chat - Minified Distribution File
 *
 * This JavaScript file is part of the minified distribution of GitSense Chat.
 * It has been optimized (minified) for performance and efficient delivery.
 *
 * This software is permitted for internal use and modification.
 * Copying for profit or redistribution is strictly not permitted.
 *
 * The Fair License, which formalizes these terms, will be adopted as the official license in the future.
 * Once finalized, the unminified source code will be freely available for internal use for non-
 * commercial purposes.
 *
 * This software may not be used to develop or enhance any product or service that competes
 * directly or indirectly with GitSense Chat without explicit permission.
 *
 * Copyright (c) 2025 GitSense. All rights reserved.
 */

let ContextUtils=require("@gitsense/gsc-utils").ContextUtils,copyToClipboard=require("../../../utils/clipboard").copyToClipboard,{formatBytes,formatTokens}=require("../../../utils/formatterUtils");function createModalFooter({container:t,contextBuilderTable:n,onCancel:e,onLoadFullContent:o,onSave:a,onAdd:l,onAskAI:s}){var t=t.querySelector(".modal-footer"),i=t.querySelector(".footer-left-container"),t=t.querySelector(".footer-right-container");let d=document.createElement("button"),c=(d.className="action-button cancel-button secondary-button",d.textContent="Cancel",d.setAttribute("aria-label","Cancel and close modal"),document.createElement("button")),r=(c.className="action-button copy-button secondary-button",c.textContent="Copy",c.setAttribute("aria-label","Copy selected content to clipboard"),c.style.display="none",document.createElement("input")),u=(r.type="text",r.className="save-name-input",r.placeholder="Enter context name",r.style.display="none",r.setAttribute("aria-label","Name for saved selection"),document.createElement("div")),y=(u.className="error-message-container",u.style.display="none",document.createElement("div")),p=(y.className="instruction-message-container",y.style.display="none",document.createElement("button")),b=(p.className="action-button secondary-button save-selection-button secondary-button-disabled",p.textContent="Create",p.setAttribute("aria-label","Use selected items"),p.style.display="none",document.createElement("button")),m=(b.className="action-button add-button primary-button",b.textContent="Add",b.setAttribute("aria-label","Add selected content to chat"),b.style.display="none",document.createElement("button")),f=(m.className="action-button secondary-button ai-button ai-button-disabled",m.textContent="Ask AI",m.setAttribute("aria-label","Ask AI about selected content"),document.createElement("button"));f.className="action-button primary-button primary-button-disabled load-full-content-button ",f.textContent="Load",f.setAttribute("aria-label","Load full content for selected items"),f.style.display="none";var C=document.createElement("button");return C.className="action-button reset-selections-button secondary-button",C.textContent="Reset Selections",C.setAttribute("aria-label","Reset all selections"),i.appendChild(u),i.appendChild(y),t.appendChild(d),t.appendChild(m),t.appendChild(f),t.appendChild(c),t.appendChild(r),t.appendChild(p),t.appendChild(b),d.addEventListener("click",()=>{"function"==typeof e&&e()}),c.addEventListener("click",async()=>{var t=n.getSelectedItems();if(0===t.length)console.warn("No items selected for copying.");else{t=ContextUtils.formatContextContent(t,t[0]?.contentType,t[0]?.contentOption);if(await copyToClipboard(t)){let t=c.textContent;c.textContent="Copied!",c.classList.add("success"),setTimeout(()=>{c.textContent=t,c.classList.remove("success")},2e3)}else alert("Failed to copy to clipboard. Please try again.")}}),p.addEventListener("click",async()=>{var t,e;a&&"function"==typeof a?(t=r.value.trim(),e=n.allItems,""===t||0===e.length?console.warn("Cannot save: No context name or items selected."):a(t,e)):console.warn("ModalFooter: Either onSave was not defined or it's  not a function")}),b.addEventListener("click",async()=>{var t,e;l&&"function"==typeof l?0===(t=n.allItems).length?console.warn("Cannot save: No items selected."):(e=ContextUtils.formatContextContent(t,t[0]?.contentType,t[0]?.contentOption),l(e,t)):console.warn("ModalFooter: Either onAdd was not defined or it's  not a function")}),f.addEventListener("click",()=>{"function"==typeof o&&o()}),m.addEventListener("click",()=>{"function"==typeof s&&s()}),r.addEventListener("keyup",()=>{""===r.value.trim()?p.classList.add("secondary-button-disabled"):p.classList.remove("secondary-button-disabled")}),{cancelButton:d,copyButton:c,contextNameInput:r,errorMessageContainer:u,hideErrorMessage:function(){u.style.display="none",u.textContent=""},loadFullContentButton:f,resetSelectionsButton:C,saveButton:p,showErrorMessage:function(t){y.style.display="none",u.textContent=t,u.style.display="block"},getSaveButtonText:function(){return p.innerText},clearContextNameInput:function(){r.value=""},disableLoadButton:function(){f.classList.add("primary-button-disabled"),f.textContent="Load"},enableLoadButton:function(){f.classList.remove("primary-button-disabled")},updateLoadButtonText:function(t,e,n,o){f.textContent=`Load Full Content (${t} of ${e} selected, ~${formatTokens(n)} tokens, ${formatBytes(o)})`},updateAddButtonText:function(t,e,n){b.textContent=`Add ${t} items (~${formatTokens(e)} tokens, ${formatBytes(n)})`},disableAiButton:function(){m.classList.add("ai-button-disabled"),m.textContent="Ask AI"},enableAiButton:function(){m.classList.remove("ai-button-disabled")},updateAskAiButtonText:function(t){m.textContent=t},enableSaveButton:function(){},disableSaveButton:function(){},updateSaveButtonText:function(t){p.textContent=t},updateVisibility:function(t,{showAskAI:e=!0,showAdd:n=!0,showCopy:o=!0,showSave:a=tarue}){if("block"===u.style.display)y.style.display="none";else switch(u.style.display="none",t){case"review":y.textContent="Select items, then click 'Load' or 'Ask AI' to review analyzed items.",y.style.display="block";break;case"full-loaded":y.textContent="Optional: Enter a name, then click 'Create' to save selections.",y.style.display="block";break;default:y.style.display="none",y.textContent=""}d.style.display=null,c.style.display=o&&"full-loaded"===t?null:"none",p.style.display=a&&"full-loaded"===t?null:"none",r.style.display="full-loaded"===t?null:"none",m.style.display="review"===t&&e?null:"none",f.style.display=!n||"review"!==t&&"full-loading"!==t?"none":null,b.style.display=n&&"full-loaded"===t?null:"none"}}}module.exports={createModalFooter:createModalFooter,formatBytes:formatBytes,formatTokens:formatTokens};
