/*
 * GitSense Chat - Minified Distribution File
 *
 * This JavaScript file is part of the minified distribution of GitSense Chat.
 * It has been optimized (minified) for performance and efficient delivery.
 *
 * This software is permitted for internal use and modification.
 * Copying for profit or redistribution is strictly not permitted.
 *
 * The Fair License, which formalizes these terms, will be adopted as the official license in the future.
 * Once finalized, the unminified source code will be freely available for internal use for non-
 * commercial purposes.
 *
 * This software may not be used to develop or enhance any product or service that competes
 * directly or indirectly with GitSense Chat without explicit permission.
 *
 * Copyright (c) 2025 GitSense. All rights reserved.
 */

let createEnhancedBreadcrumbSystem=(e={})=>{let s={ellipsis:"...",minWordLength:3,preserveItems:["last"],minTruncateLength:5,cacheTimeout:5e3,maxCacheSize:100,...e},u=((t=>{if(["ellipsis","minWordLength","minTruncateLength"].forEach(e=>{if(void 0===t[e])throw new Error("Missing required option: "+e)}),t.minTruncateLength<1)throw new Error("minTruncateLength must be at least 1");if(t.minWordLength<1)throw new Error("minWordLength must be at least 1")})(s),{results:new Map,timeouts:new Map,set:(e,t)=>{u.timeouts.has(e)&&clearTimeout(u.timeouts.get(e)),u.results.set(e,t);var t=setTimeout(()=>{u.results.delete(e),u.timeouts.delete(e)},s.cacheTimeout);u.timeouts.set(e,t),u.results.size>s.maxCacheSize&&(t=u.results.keys().next().value,u.results.delete(t),u.timeouts.has(t))&&(clearTimeout(u.timeouts.get(t)),u.timeouts.delete(t))},get:e=>u.results.get(e),has:e=>u.results.has(e),clear:()=>{u.timeouts.forEach(clearTimeout),u.timeouts.clear(),u.results.clear()}}),c={calculateTotalLength:e=>e.reduce((e,t)=>e+t.text.length,0),needsTruncation:(e,t)=>c.calculateTotalLength(e)>t,validateBreadcrumb:e=>{if(!e||"object"!=typeof e)throw new Error("Invalid breadcrumb item");if("string"!=typeof e.text)throw new Error("Breadcrumb text must be a string");if(0===e.text.trim().length)throw new Error("Breadcrumb text cannot be empty");return!0},validateMaxLength:e=>{if(!Number.isFinite(e)||e<=0)throw new Error("Max length must be a positive number");return!0},calculateItemLengths:(e,t,r)=>{let n=new Array(t).fill(0),l=e;if(n.forEach((e,t)=>{n[t]=r,l-=r}),0<l){let r=Math.floor(l/t),a=l%t;n.forEach((e,t)=>{n[t]+=r,t<a&&(n[t]+=1)})}return n}};let o={truncateText:(e,t)=>{return e.length<=t||(t=t,(e=e).length<=t)?e:t<=s.minTruncateLength?e.slice(0,t-1)+s.ellipsis:(t=t-s.ellipsis.length,r=Math.ceil(t/2),t=Math.floor(t/2),r=e.slice(0,r),e=e.slice(-t),""+r+s.ellipsis+e);var r}},h={singleItem:(e,t)=>({...e,truncatedText:o.truncateText(e.text,t),originalText:e.text}),tooShort:(r,e)=>e<r.length*(s.minTruncateLength+s.ellipsis.length)?r.map((e,t)=>t===r.length-1?e:{...e,truncatedText:e.text.slice(0,1)+s.ellipsis,originalText:e.text}):null,allEqual:(e,t)=>{let r=Math.floor((t-s.ellipsis.length*(e.length-1))/e.length);return r>=s.minTruncateLength?e.map(e=>({...e,truncatedText:o.truncateText(e.text,r),originalText:e.text})):null}};return{truncateBreadcrumbs:(e,t)=>{try{if(Array.isArray(e)&&e.length)return e.forEach(c.validateBreadcrumb),c.validateMaxLength(t),((t,r)=>{var a=t.map(e=>e.text).join("|")+":"+r;if(u.has(a))return u.get(a);if(1===t.length){let e=[h.singleItem(t[0],r)];return u.set(a,e),e}var e=h.tooShort(t,r);if(e)return u.set(a,e),e;if(!c.needsTruncation(t,r))return u.set(a,t),t;e=r-t[t.length-1].text.length;let n=[...t];var l=c.calculateItemLengths(e,t.length-1,s.minTruncateLength);for(let e=0;e<t.length-1;e++){var i=t[e];i.text.length>l[e]&&(n[e]={...i,truncatedText:o.truncateText(i.text,l[e]),originalText:i.text})}return u.set(a,n),n})(e,t);throw new Error("Breadcrumbs must be a non-empty array")}catch(e){throw console.error("Breadcrumb truncation error:",e.message),e}},getTotalLength:e=>c.calculateTotalLength(e),needsTruncation:(e,t)=>c.needsTruncation(e,t),getOptions:()=>({...s}),clearCache:()=>u.clear(),debug:{validateBreadcrumb:c.validateBreadcrumb,validateMaxLength:c.validateMaxLength,getCacheSize:()=>u.results.size,calculateLengths:e=>({total:c.calculateTotalLength(e),individual:e.map(e=>({text:e.text,length:e.text.length}))})}}};module.exports={createEnhancedBreadcrumbSystem:createEnhancedBreadcrumbSystem};
